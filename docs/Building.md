# Building RetroZig
This guide provides instructions for building the Stage 0 bootstrap compiler (`zig0`) and compiling the generated C89 code.

## 1. Building the Stage 0 Compiler (`zig0`)

### 1.1 Linux / POSIX
On a modern Linux system, you need `g++` (C++98 compatible) and `make`.

**Direct Compilation:**
```bash
g++ -std=c++98 -Isrc/include src/bootstrap/bootstrap_all.cpp -o zig0
```

### 1.2 Windows 98 / MSVC 6.0
To produce `zig0.exe` on Windows 98, you need **Microsoft Visual C++ 6.0 (Service Pack 6 recommended)**.

#### Environment Setup
You must ensure that the MSVC binaries and libraries are in your environment paths. You can set them manually in a batch script:

```batch
@echo off
:: Adjust paths to your MSVC 6.0 installation
set MSVC_DIR=C:\Program Files\Microsoft Visual Studio\VC98
set PATH=%MSVC_DIR%\Bin;%PATH%
set INCLUDE=%MSVC_DIR%\Include
set LIB=%MSVC_DIR%\Lib
```

#### Compilation
Use the `cl` command to build the compiler:

```batch
cl /Za /W3 /Isrc/include src\bootstrap\bootstrap_all.cpp /Fezig0.exe
```

---

## 2. Compiling Generated C89 Code

The `zig0` compiler generates C89 code. To compile this code into an executable, use the following tools and flags.

### 2.1 Recommended MSVC 6.0 Flags
When compiling the `.c` files generated by `zig0`, the following flags are recommended for maximum compatibility and performance on Pentium-class hardware:

| Flag | Description |
|------|-------------|
| `/Za` | Disable language extensions (Strict C89). |
| `/W3` | Enable warning level 3. |
| `/G5` | Optimize for Pentium processors. |
| `/TC` | Treat all files as C source. |
| `/c`  | Compile only (no link). |
| `/Fo` | Specify object file name. |
| `/Fe` | Specify executable name. |

**Example Command:**
```batch
:: Compile the runtime and the main module
cl /Za /W3 /G5 /TC zig_runtime.c main_module.c /Femain.exe
```

### 2.2 GCC Flags
To verify C89 compliance on modern systems:
```bash
gcc -std=c89 -pedantic -Wall zig_runtime.c main_module.c -o main
```

---

## 3. Toolchain Summary

| Tool | Target | Version |
|------|--------|---------|
| MSVC 6.0 | Windows 9x | Service Pack 6 |
| GCC | Linux/Modern | 3.x or 4.x (using -std=c89) |
| g++ | Host (zig0) | C++98 compatible |
